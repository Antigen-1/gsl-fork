/* Author:  G. Jungman
 * RCS:     $Id$
 */
#include <gsl_math.h>
#include <gsl_errno.h>
#include "gsl_sf_chebyshev.h"
#include "gsl_sf_elementary.h"
#include "gsl_sf_exp.h"
#include "gsl_sf_gamma.h"
#include "gsl_sf_zeta.h"

#define LogTwoPi_  1.8378770664093454835606594728111235279723


/*-*-*-*-*-*-*-*-*-*-*-* Private Section *-*-*-*-*-*-*-*-*-*-*-*/

/* chebyshev fit for (s(x)-1)Zeta[s(x)],  s(x)= (x+1)/2,  -1 <= x <= 1 */
static double zeta_xlt1_data[14] = {
  1.48018677156931561235192914649,
  0.250120625398894264719999381666,
  0.0099113750213536077424376146719,
 -0.000120847596566764103298330914680,
 -4.7585866367662556504652535281e-6,
  2.22299466944663918555614413609e-7,
 -2.22374964980302571213090565816e-9,
 -1.01732265132290283194207990278e-10,
  4.3756643450424558284466248449e-12,
 -6.2229632593100551465504090814e-14,
 -6.6116201003272207115277520305e-16,
  4.9477279533373912324518463830e-17,
 -1.04298190934561897196600035218e-18,
  6.9925216166580021051464412040e-21,
};
static struct gsl_sf_cheb_series zeta_xlt1_cs = {
  zeta_xlt1_data,
  13,
  -1, 1,
  (double *)0,
  (double *)0
};

/* chebyshev fit for (s(x)-1)Zeta[s(x)],  s(x)= (19x+21)/2,  -1 <= x <= 1 */
static double zeta_xgt1_data[30] = {
  19.3918515726724119415911269006,
   9.1525329692510756181581271500,
   0.242789765886737998536527015482,
  -0.133900068826202733831664132878,
   0.057782706406502859557841020184,
  -0.0187625983754002298566409700423,
   0.0039403014258320354840823803150,
  -0.000058150827315812796359888250536,
  -0.00037561489072148207045945492833,
   0.000189253054810921434909299963724,
  -0.000054903219969551349611509035920,
   8.7086484008939038610413331863e-6,
   6.4609477924811889068410083425e-7,
  -9.6749773915059089205835337136e-7,
   3.6585400766767257736982342461e-7,
  -8.4592516427275164351876072573e-8,
   9.9956786144497936572288988883e-9,
   1.42600364209511181124571448418e-9,
  -1.17619688233828791953803209478e-9,
   3.7114575899785204664648987295e-10,
  -7.4756855194210961661210215325e-11,
   7.8536934209183700456512982968e-12,
   9.9827182259685539619810406271e-13,
  -7.5276687030192221587850302453e-13,
   2.19550263939642799889178786544e-13,
  -4.1934859852834647427576319246e-14,
   4.6341149635933550715779074274e-15,
   2.37424885090483401068303094027e-16,
  -2.72765163881247861193238243915e-16,
   7.8473570134636044722154797225e-17
};
static struct gsl_sf_cheb_series zeta_xgt1_cs = {
  zeta_xgt1_data,
  29,
  -1, 1,
  (double *)0,
  (double *)0
};


/* assumes s > 0,  product representation */
#ifdef HAVE_INLINE
inline
#endif
static
double riemann_zeta_prod(double s)
{
  double f2 = 1.0 - pow(2.0,-s);
  double f3 = 1.0 - pow(3.0,-s);
  double f5 = 1.0 - pow(5.0,-s);
  double f7 = 1.0 - pow(7.0,-s);
  return 1.0/(f2*f3*f5*f7);
}

/* assumes s >= 0 and s != 1.0 */
#ifdef HAVE_INLINE
inline
#endif
static
double riemann_zeta_sgt0(double s)
{
  if(s < 1.0) {
    return gsl_sf_cheb_eval(&zeta_xlt1_cs, 2.0*s - 1.0) / (s - 1.0);
  }
  else if(s <= 20.0) {
    double x = (2.*s - 21.)/19.;
    return gsl_sf_cheb_eval(&zeta_xgt1_cs, x) / (s - 1.0);
  }
  else {
    return riemann_zeta_prod(s);
  }
}

/* zeta(n) */
#define ZETA_POS_TABLE_NMAX   100
static double zeta_pos_int_table[ZETA_POS_TABLE_NMAX+1] = {
 -0.50000000000000000000000000000,       /* zeta(0) */
  0.0 /* FIXME: DirectedInfinity() */,   /* zeta(1) */
  1.64493406684822643647241516665,       /* ...     */
  1.20205690315959428539973816151,
  1.08232323371113819151600369654,
  1.03692775514336992633136548646,
  1.01734306198444913971451792979,
  1.00834927738192282683979754985,
  1.00407735619794433937868523851,
  1.00200839282608221441785276923,
  1.00099457512781808533714595890,
  1.00049418860411946455870228253,
  1.00024608655330804829863799805,
  1.00012271334757848914675183653,
  1.00006124813505870482925854511,
  1.00003058823630702049355172851,
  1.00001528225940865187173257149,
  1.00000763719763789976227360029,
  1.00000381729326499983985646164,
  1.00000190821271655393892565696,
  1.00000095396203387279611315204,
  1.00000047693298678780646311672,
  1.00000023845050272773299000365,
  1.00000011921992596531107306779,
  1.00000005960818905125947961244,
  1.00000002980350351465228018606,
  1.00000001490155482836504123466,
  1.00000000745071178983542949198,
  1.00000000372533402478845705482,
  1.00000000186265972351304900640,
  1.00000000093132743241966818287,
  1.00000000046566290650337840730,
  1.00000000023283118336765054920,
  1.00000000011641550172700519776,
  1.00000000005820772087902700889,
  1.00000000002910385044497099687,
  1.00000000001455192189104198424,
  1.00000000000727595983505748101,
  1.00000000000363797954737865119,
  1.00000000000181898965030706595,
  1.00000000000090949478402638893,
  1.00000000000045474737830421540,
  1.00000000000022737368458246525,
  1.00000000000011368684076802278,
  1.00000000000005684341987627586,
  1.00000000000002842170976889302,
  1.00000000000001421085482803161,
  1.00000000000000710542739521085,
  1.00000000000000355271369133711,
  1.00000000000000177635684357912,
  1.00000000000000088817842109308,
  1.00000000000000044408921031438,
  1.00000000000000022204460507980,
  1.00000000000000011102230251411,
  1.00000000000000005551115124845,
  1.00000000000000002775557562136,
  1.00000000000000001387778780973,
  1.00000000000000000693889390454,
  1.00000000000000000346944695217,
  1.00000000000000000173472347605,
  1.00000000000000000086736173801,
  1.00000000000000000043368086900,
  1.00000000000000000021684043450,
  1.00000000000000000010842021725,
  1.00000000000000000005421010862,
  1.00000000000000000002710505431,
  1.00000000000000000001355252716,
  1.00000000000000000000677626358,
  1.00000000000000000000338813179,
  1.00000000000000000000169406589,
  1.00000000000000000000084703295,
  1.00000000000000000000042351647,
  1.00000000000000000000021175824,
  1.00000000000000000000010587912,
  1.00000000000000000000005293956,
  1.00000000000000000000002646978,
  1.00000000000000000000001323489,
  1.00000000000000000000000661744,
  1.00000000000000000000000330872,
  1.00000000000000000000000165436,
  1.00000000000000000000000082718,
  1.00000000000000000000000041359,
  1.00000000000000000000000020680,
  1.00000000000000000000000010340,
  1.00000000000000000000000005170,
  1.00000000000000000000000002585,
  1.00000000000000000000000001292,
  1.00000000000000000000000000646,
  1.00000000000000000000000000323,
  1.00000000000000000000000000162,
  1.00000000000000000000000000081,
  1.00000000000000000000000000040,
  1.00000000000000000000000000020,
  1.00000000000000000000000000010,
  1.00000000000000000000000000005,
  1.00000000000000000000000000003,
  1.00000000000000000000000000001,
  1.00000000000000000000000000001,
  1.00000000000000000000000000000,
  1.00000000000000000000000000000,
  1.00000000000000000000000000000
};
#define ZETA_NEG_TABLE_NMAX  99
#define ZETA_NEG_TABLE_SIZE  50
static double zeta_neg_int_table[ZETA_NEG_TABLE_SIZE] = {
 -0.083333333333333333333333333333,      /* zeta(-1) */
  0.0083333333333333333333333333333,     /* zeta(-3) */
 -0.0039682539682539682539682539683,     /* ...      */
  0.0041666666666666666666666666667,
 -0.0075757575757575757575757575758,
  0.0210927960927960927960927960928,
 -0.083333333333333333333333333333,
  0.44325980392156862745098039216,
 -3.05395433027011974380395433027,
  26.4562121212121212121212121212,
 -281.460144927536231884057971014,
  3607.5105463980463980463980464,
 -54827.583333333333333333333333,
  974936.82385057471264367816092,
 -2.00526957966880789461434622725e7,
  4.7238486772162990196078431373e8,
 -1.26357247959166666666666666667e10,
  3.8087931125245368811553022079e11,
 -1.28508504993050833333333333333e13,
  4.8241448354850170371581670362e14,
 -2.00403106565162527381084216632e16,
  9.1677436031953307756992753623e17,
 -4.5979888343656503490437943262e19,
  2.51804719214510956970890233202e21,
 -1.50017334921539287337114401515e23,
  9.6899578874635940656497942895e24,
 -6.7645882379292820990945242302e26,
  5.0890659468662289689766332916e28,
 -4.1147288792557978697665486068e30,
  3.5666582095375556109684574609e32,
 -3.3066089876577576725680214670e34,
  3.2715634236478716264211227016e36,
 -3.4473782558278053878256455080e38,
  3.8614279832705258893092720200e40,
 -4.5892974432454332168863989006e42,
  5.7775386342770431824884825688e44,
 -7.6919858759507135167410075972e46,
  1.08136354499716546963540333511e49,
 -1.60293645220089654060671023458e51,
  2.50194790415604628436566614985e53,
 -4.1067052335810212479752045004e55,
  7.0798774408494580617452972433e57,
 -1.28045468879395087901908497563e60,
  2.42673403923335240780208920671e62,
 -4.8143218874045769355129570066e64,
  9.9875574175727530680652777408e66,
 -2.16456348684351856313351361598e69,
  4.8962327039620553206849224516e71,     /* ...        */
 -1.15490239239635196639542716916e74,    /* zeta(-97)  */
  2.83822495706937069592641563365e76     /* zeta(-99)  */
};


/* coefficients for Maclaurin summation in hzeta()
 * B_{2j}/(2j)!
 */
static double hzeta_c[15] = {
  1.00000000000000000000000000000,
  0.083333333333333333333333333333,
 -0.00138888888888888888888888888889,
  0.000033068783068783068783068783069,
 -8.2671957671957671957671957672e-7,
  2.08767569878680989792100903212e-8,
 -5.2841901386874931848476822022e-10,
  1.33825365306846788328269809751e-11,
 -3.3896802963225828668301953912e-13,
  8.5860620562778445641359054504e-15,
 -2.17486869855806187304151642387e-16,
  5.5090028283602295152026526089e-18,
 -1.39544646858125233407076862641e-19,
  3.5347070396294674716932299778e-21,
 -8.9535174270375468504026113181e-23
};

#define ETA_POS_TABLE_NMAX  100
static double eta_pos_int_table[ETA_POS_TABLE_NMAX+1] = {
0.50000000000000000000000000000,  /* eta(0) */
M_LN2,                            /* eta(1) */
0.82246703342411321823620758332,  /* ...    */
0.90154267736969571404980362113,
0.94703282949724591757650323447,
0.97211977044690930593565514355,
0.98555109129743510409843924448,
0.99259381992283028267042571313,
0.99623300185264789922728926008,
0.99809429754160533076778303185,
0.99903950759827156563922184570,
0.99951714349806075414409417483,
0.99975768514385819085317967871,
0.99987854276326511549217499282,
0.99993917034597971817095419226,
0.99996955121309923808263293263,
0.99998476421490610644168277496,
0.99999237829204101197693787224,
0.99999618786961011347968922641,
0.99999809350817167510685649297,
0.99999904661158152211505084256,
0.99999952325821554281631666433,
0.99999976161323082254789720494,
0.99999988080131843950322382485,
0.99999994039889239462836140314,
0.99999997019885696283441513311,
0.99999998509923199656878766181,
0.99999999254955048496351585274,
0.99999999627475340010872752767,
0.99999999813736941811218674656,
0.99999999906868228145397862728,
0.99999999953434033145421751469,
0.99999999976716989595149082282,
0.99999999988358485804603047265,
0.99999999994179239904531592388,
0.99999999997089618952980952258,
0.99999999998544809143388476396,
0.99999999999272404460658475006,
0.99999999999636202193316875550,
0.99999999999818101084320873555,
0.99999999999909050538047887809,
0.99999999999954525267653087357,
0.99999999999977262633369589773,
0.99999999999988631316532476488,
0.99999999999994315658215465336,
0.99999999999997157829090808339,
0.99999999999998578914539762720,
0.99999999999999289457268000875,
0.99999999999999644728633373609,
0.99999999999999822364316477861,
0.99999999999999911182158169283,
0.99999999999999955591079061426,
0.99999999999999977795539522974,
0.99999999999999988897769758908,
0.99999999999999994448884878594,
0.99999999999999997224442439010,
0.99999999999999998612221219410,
0.99999999999999999306110609673,
0.99999999999999999653055304826,
0.99999999999999999826527652409,
0.99999999999999999913263826204,
0.99999999999999999956631913101,
0.99999999999999999978315956551,
0.99999999999999999989157978275,
0.99999999999999999994578989138,
0.99999999999999999997289494569,
0.99999999999999999998644747284,
0.99999999999999999999322373642,
0.99999999999999999999661186821,
0.99999999999999999999830593411,
0.99999999999999999999915296705,
0.99999999999999999999957648353,
0.99999999999999999999978824176,
0.99999999999999999999989412088,
0.99999999999999999999994706044,
0.99999999999999999999997353022,
0.99999999999999999999998676511,
0.99999999999999999999999338256,
0.99999999999999999999999669128,
0.99999999999999999999999834564,
0.99999999999999999999999917282,
0.99999999999999999999999958641,
0.99999999999999999999999979320,
0.99999999999999999999999989660,
0.99999999999999999999999994830,
0.99999999999999999999999997415,
0.99999999999999999999999998708,
0.99999999999999999999999999354,
0.99999999999999999999999999677,
0.99999999999999999999999999838,
0.99999999999999999999999999919,
0.99999999999999999999999999960,
0.99999999999999999999999999980,
0.99999999999999999999999999990,
0.99999999999999999999999999995,
0.99999999999999999999999999997,
0.99999999999999999999999999999,
0.99999999999999999999999999999,
1.00000000000000000000000000000,
1.00000000000000000000000000000,
1.00000000000000000000000000000,
};


#define ETA_NEG_TABLE_NMAX  99
#define ETA_NEG_TABLE_SIZE  50
static double eta_neg_int_table[ETA_NEG_TABLE_SIZE] = {
 0.250000000000000000000000000000,   /* eta(-1) */
-0.125000000000000000000000000000,   /* eta(-3) */
 0.250000000000000000000000000000,   /* ...      */
-1.062500000000000000000000000000,
 7.750000000000000000000000000000,
-86.37500000000000000000000000000,
 1365.250000000000000000000000000,
-29049.03125000000000000000000000,
 800572.7500000000000000000000000,
-2.77413226250000000000000000000e7,
 1.18052913025000000000000000000e9,
-6.0523980051687500000000000000e10,
 3.6794167785377500000000000000e12,
-2.61707609906583875000000000000e14,
 2.15314181408002952500000000000e16,
-2.02887755751730159301562500000e18,
 2.17080099026237705902750000000e20,
-2.61738269684558149321201250000e22,
 3.5324148876863877826668602500e24,
-5.3042033406864906641493838981e26,
 8.8138218364311576767253114668e28,
-1.61280651074907785473546548642e31,
 3.2355470001722734208527794569e33,
-7.0876727476537493198506645215e35,
 1.68904503412939657791756293891e38,
-4.3639690731216831157655651358e40,
 1.21859988270612613226050656716e43,
-3.6670584803153006180101262324e45,
 1.18598985263020991042714497483e48,
-4.1120769493584015047981746438e50,
 1.52490424367876203090901686869e53,
-6.0349693196941307074572991901e55,
 2.54371617642106958231976915195e58,
-1.13969238026322878511303601696e61,
 5.4180861064753979196802726455e63,
-2.72836547999943738472871971041e66,
 1.45297505149185432385111716635e69,
-8.1705519371067450079777183386e71,
 4.8445781606678367790247757259e74,
-3.02466942066495193361794480177e77,
 1.98588079616904930541690479697e80,
-1.36944746207200869943868182325e83,
 9.9070382984295807826303785989e85,
-7.5103780796592645925968460677e88,
 5.9598418264260880840077992227e91,
-4.9455988887500020399263196307e94,
 4.2873596927020241277675775935e97,
-3.8791952037716162900707994047e100,
 3.6600317773156342245401829308e103,
-3.5978775704117283875784869570e106    /* eta(-99)  */
};


/*-*-*-*-*-*-*-*-*-*-*-* (semi)Private Implementations *-*-*-*-*-*-*-*-*-*-*-*/

/* checked OK [GJ] Wed May  6 11:33:23 MDT 1998 */
int gsl_sf_hzeta_impl(const double s, const double q, double * result)
{
  double ln_term0;

  if(s <= 1.0 || q <= 0.0) {
    return GSL_EDOM;
  }
  
  ln_term0 = -s * log(q);  
  if(ln_term0 < GSL_LOG_DBL_MIN + 1.0) {
    *result = 0.0;
    return GSL_EUNDRFLW;
  }
  else if(ln_term0 > GSL_LOG_DBL_MAX - 1.0) {
    *result = 0.0; /* FIXME: should be Inf */
    return GSL_EOVRFLW;
  }
  
  if(s > 50.0 && q < 0.25) {
    *result = pow(q, -s) + pow(q + 1.0, -s) + pow(q + 2.0, -s);
    return GSL_SUCCESS;
  }
  else {
    /* Euler-Maclaurin summation formula 
       [Moshier, p. 400, with several typo corrections]
     */
    int j, k;
    const int jmax = 12;
    const int kmax = 10;
    const double pmax  = pow(kmax + q, -s);
    double scp = s;
    double pcp = pmax / (kmax + q);
    double ans = pmax*((kmax+q)/(s-1.0) + 0.5);
    
    for(k=0; k<kmax; k++) {
      ans += pow(k + q, -s);
    }

    for(j=0; j<=jmax; j++) {
      double delta = hzeta_c[j+1] * scp * pcp;
      ans += delta;
      if(fabs(delta/ans) < 0.5*GSL_MACH_EPS) break;
      scp *= (s+2*j+1)*(s+2*j+2);
      pcp /= (kmax + q)*(kmax + q);
    }
    
    *result = ans;
    return GSL_SUCCESS;
  }
}


/* checked OK [GJ] Tue May  5 20:38:59 MDT 1998 */
int gsl_sf_zeta_impl(const double s, double * result)
{
  if(s == 1.0) {
    return GSL_EDOM;
  }

  if(s >= 0.0) {
    *result = riemann_zeta_sgt0(s);
    return GSL_SUCCESS;
  }
  else {
    /* reflection formula, [Abramowitz+Stegun, 23.2.5] */
    double ln_gamma;
    double ln_pre = s * LogTwoPi_;
    double zeta_one_minus_s = riemann_zeta_sgt0(1.0-s);
    double ln_term;
    gsl_sf_lngamma_impl(1.0-s, &ln_gamma);
    ln_term  = ln_pre + ln_gamma;
    if(ln_term < GSL_LOG_DBL_MAX - 1.0) {
      *result = sin(0.5*M_PI*s)/M_PI * exp(ln_term) * zeta_one_minus_s;
      return GSL_SUCCESS;
    }
    else {
      *result = 0.0; /* FIXME: should be Inf */
      return GSL_EOVRFLW;
    }
  }
}

/* checked OK [GJ] Tue May  5 20:34:39 MDT 1998 */
int gsl_sf_zeta_int_impl(const int n, double * result)
{
  if(n < 0) {
    if(!GSL_IS_ODD(abs(n))) {
      *result = 0.0; /* exactly zero at even negative integers */
      return GSL_SUCCESS;
    }
    else if(n > -ZETA_NEG_TABLE_NMAX) {
      *result = zeta_neg_int_table[-(n+1)/2];
      return GSL_SUCCESS;
    }
    else {
      return gsl_sf_zeta_impl((double)n, result);
    }
  }
  else if(n == 1){
    return GSL_EDOM;
  }
  else if(n <= ZETA_POS_TABLE_NMAX){
    *result = zeta_pos_int_table[n];
    return GSL_SUCCESS;
  }
  else {
    *result = 1.0;
    return GSL_SUCCESS;
  }
}


int gsl_sf_eta_int_impl(int n, double * result)
{
  if(n > ETA_POS_TABLE_NMAX) {
    *result = 1.0;
    return GSL_SUCCESS;
  }
  else if(n > 0) {
    *result = eta_pos_int_table[n];
    return GSL_SUCCESS;
  }
  else {
    /* n < 0 */

    if(!GSL_IS_ODD(n)) {
      /* exactly zero at even negative integers */
      *result = 0.0;
      return GSL_SUCCESS;
    }
    else if(n > -ETA_NEG_TABLE_NMAX) {
      *result = eta_neg_int_table[-(n+1)/2];
      return GSL_SUCCESS;
    }
    else {
      double z;
      double p;
      int stat_z = gsl_sf_zeta_int_impl(n, &z);
      int stat_p = gsl_sf_exp_impl((1.0-n)*M_LN2, &p);
      int stat_m = gsl_sf_multiply_impl(-p, z, result);
      return GSL_ERROR_SELECT_3(stat_m, stat_p, stat_z);
    }
  }
}


int gsl_sf_eta_impl(const double s, double * result)
{
  if(s > 100.0) {
    *result = 1.0;
    return GSL_SUCCESS;
  }
  else if(fabs(s-1.0) < 10.0*GSL_ROOT5_MACH_EPS) {
    double del = s-1.0;
    double c0  = M_LN2;
    double c1  = M_LN2 * (M_EULER - 0.5*M_LN2);
    double c2  = -0.0326862962794492996;
    double c3  =  0.0015689917054155150;
    double c4  =  0.00074987242112047532;
    *result = c0 + del * (c1 + del * (c2 + del * (c3 + del * c4)));
    return GSL_SUCCESS;
  }
  else {
    double z;
    double p;
    int stat_z = gsl_sf_zeta_impl(s, &z);
    int stat_p = gsl_sf_exp_impl((1.0-s)*M_LN2, &p);
    int stat_m = gsl_sf_multiply_impl(1.0-p, z, result);
    return GSL_ERROR_SELECT_3(stat_m, stat_p, stat_z);
  }
}


/*-*-*-*-*-*-*-*-*-*-*-* Error Handling Versions *-*-*-*-*-*-*-*-*-*-*-*/

int gsl_sf_zeta_e(const double s, double * result)
{
  int status = gsl_sf_zeta_impl(s, result);
  if(status != GSL_SUCCESS) {
    GSL_ERROR("gsl_sf_zeta_e", status);
  }
  return status;
}

int gsl_sf_hzeta_e(const double s, const double a, double * result)
{
  int status = gsl_sf_hzeta_impl(s, a, result);
  if(status != GSL_SUCCESS) {
    GSL_ERROR("gsl_sf_hzeta_e", status);
  }
  return status;
}

int gsl_sf_zeta_int_e(const int s, double * result)
{
  int status = gsl_sf_zeta_int_impl(s, result);
  if(status != GSL_SUCCESS) {
    GSL_ERROR("gsl_sf_zeta_int_e", status);
  }
  return status;
}

int gsl_sf_eta_int_e(const int s, double * result)
{
  int status = gsl_sf_eta_int_impl(s, result);
  if(status != GSL_SUCCESS) {
    GSL_ERROR("gsl_sf_eta_int_e", status);
  }
  return status;
}


int gsl_sf_eta_e(const double s, double * result)
{
  int status = gsl_sf_eta_impl(s, result);
  if(status != GSL_SUCCESS) {
    GSL_ERROR("gsl_sf_eta_e", status);
  }
  return status;
}


/*-*-*-*-*-*-*-*-*-*-*-* Functions w/ Natural Prototypes *-*-*-*-*-*-*-*-*-*-*-*/

double gsl_sf_zeta(const double s)
{
  double y;
  int status = gsl_sf_zeta_impl(s, &y);
  if(status != GSL_SUCCESS) {
    GSL_WARNING("gsl_sf_zeta", status);
  }
  return y;
}

double gsl_sf_hzeta(const double s, const double a)
{
  double y;
  int status = gsl_sf_hzeta_impl(s, a, &y);
  if(status != GSL_SUCCESS) {
    GSL_WARNING("gsl_sf_hzeta_e", status);
  }
  return y;
}

double gsl_sf_zeta_int(const int n)
{
  double y;
  int status = gsl_sf_zeta_int_impl(n, &y);
  if(status != GSL_SUCCESS) {
    GSL_WARNING("gsl_sf_zeta_int", status);
  }
  return y;
}

double gsl_sf_eta_int(const int n)
{
  double y;
  int status = gsl_sf_eta_int_impl(n, &y);
  if(status != GSL_SUCCESS) {
    GSL_WARNING("gsl_sf_eta_int", status);
  }
  return y;
}

double gsl_sf_eta(const double s)
{
  double y;
  int status = gsl_sf_eta_impl(s, &y);
  if(status != GSL_SUCCESS) {
    GSL_WARNING("gsl_sf_eta", status);
  }
  return y;
}
